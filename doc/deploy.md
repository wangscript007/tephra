# 部署蓝图

![部署蓝图](doc/uml/front/deploy/main.png "部署蓝图")

- 分发器——请求入口，实现请求的转发，主要目的是配置负载均衡，以实现服务节点逐一更新，从而达到不停服更新的目标。可使用HaProxy或Nginx等免费开源产品，并使用Keepalived等实现双活以增加分发器的稳定性。
- 文件群——提供静态资源文件服务，通常这部分数据对CPU、内存等资源要求不高，但对磁盘、带宽流量等需求较大，独立出来可以降低服务器成本，并减少对核心业务的影响，当然必要时也可通过CND服务进行加速。
- 服务群——核心业务处理群，各节点间共享缓存数据，使得任一节点更新、宕机时，其它节点仍可提供正常业务处理能力。
- 数据中心——数据存储群，提供主-从部署以提高数据安全性，并支持服务群的读写分离、读负载均衡等需求。
- Hadoop群——大数据分析群，通常可部署在企业内部网络（映射外网访问端口）以降低运营成本，并能快速增加处理能力。

## 标准部署

![标准部署](doc/uml/front/deploy/standard.png "标准部署")

- 分发器——独占一个物理主机，并拥有较大带宽及网络流量，但CPU、内存、磁盘空间等要求均不高。
- 文件群——至少部署2个节点，以提供部分冗余的存储需求，拥有较大磁盘空间，但CPU、内存等要求不高。
- 服务群——至少部署3个节点，对CPU、内存要求较高，并且如果部署全冗余方式的缓存则需配置较大容量的内存空间。
- 数据中心——至少部署3个节点，其中一个主库节点提供写支持，2个从库提供读支持。
- Hadoop群——至少部署5个节点以支持双NameNode配置，降低NameNode硬件风险。但对硬件要求不高，普通PC机即可。

## 最小化部署

最小部署需要两台主机，建议在前期使用。前期更新频率高，业务处理压力低，最小部署足以满足需求，也能更有效地使用服务器资源，降低硬件及维护成本。

![最小化部署](doc/uml/front/deploy/min.png "最小化部署")

## 升级 & 迁移

从最小部署升级到标准部署，并不需要一蹴而就，而是可以根据产品的进展逐步推进：
1. 独立主数据节点，以提升数据安全性。
1. 独立从数据节点以提升数据处理能力。
1. 独立服务节点以降低硬件风险。
1. 增加服务节点以提升服务能力。
1. 增加文件节点以提升文件存储能力。
1. 创建Hadoop群进行数据分析与挖掘。
